<div class="header">
  <base href="{{ .Site.BaseURL }}">
  <h1 class="site-title"><a href="{{ .Site.BaseURL }}">{{ .Site.Title }}</a></h1>
  <div class="site-description">
	{{- if isset .Site.Params "subtitle" -}}
	<h2>{{ .Site.Params.Subtitle | markdownify }}</h2>
	{{- end -}}
	<nav class="nav social">
	  <ul class="flat">
		{{- range $index, $key := .Site.Params.Social -}}
		<a href="{{ $key.url }}" title="{{ $key.name }}"><i data-feather="{{ $key.icon }}"></i></a>
		{{- end -}}
	  </ul>
	</nav>
  </div>

  <nav class="nav">
	<ul class="flat" style="display: flex; align-items: center; width: 100%;">
	  {{ range .Site.Menus.main }}
	  <li>
		<a href="{{ .URL }}">{{ .Name }}</a>
	  </li>
	  {{ end }}
	  <link href="/pagefind/pagefind-ui.css" rel="stylesheet">
	  <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
      <!-- CSS Styles -->
      <style>
          /* 1. Pagefind Dark Mode Overrides */
          :root {
              --pagefind-ui-text: #eeeeee;
              --pagefind-ui-background: #111111; 
              --pagefind-ui-border: #333333;
          }
      
          /* 2. Search Input Styling */
          .pagefind-ui__search-input {
              background-color: transparent !important;
              border: 0 !important;
              border-bottom: 2px solid #FF7979 !important;
              border-radius: 0 !important;
              padding-left: 2.5rem !important;
              color: inherit !important;
              font-size: 1rem;
          }
          
          .pagefind-ui__search-input:focus {
              outline: none !important;
              box-shadow: none !important;
              border-bottom: 2px solid #984848 !important;
          }
      
          .pagefind-ui__search-clear {
              background-color: transparent !important;
          }
      
          /* 3. RESPONSIVE LAYOUT FIXES */
          .nav { width: 100%; }
          
          .nav .flat { 
              display: flex; 
              align-items: center; 
              width: 100%; 
              margin: 0; padding: 0;
              flex-wrap: wrap; 
          }
          
          .nav .flat li { 
              margin-right: 15px; 
              list-style: none;
              flex-shrink: 0; 
          }
          
          .nav .flat li a { white-space: nowrap; }
      
          /* Search Wrapper */
          li.search-wrap {
              margin-left: auto !important; 
              display: flex;
              align-items: center;
              /* Kept static so drawer positions relative to body/nav-container, NOT this tiny li */
              position: static !important; 
              flex-shrink: 0;
          }
      
          #search {
              width: 200px;
              margin-top: -4px;
              position: relative; 
          }
      
          /* 4. RESULTS DRAWER FIX - ANCHORED RIGHT */
          .pagefind-ui__drawer {
              position: absolute !important;
              top: 80px !important; /* Adjust if your header is taller/shorter */
              
              /* ANCHOR TO RIGHT: This prevents it from flying off the right edge */
              right: 1vw !important; 
              left: auto !important; 
              
              /* Responsive Width */
              width: 90vw !important; 
              max-width: 600px !important; /* Keeps it readable on large screens */
              
              z-index: 9999 !important; 
              background-color: #000000 !important; 
              border: 1px solid #333 !important;
              box-shadow: 0 10px 30px rgba(0,0,0, 1) !important;
              padding: 15px !important; 
              border-radius: 8px !important;
              box-sizing: border-box !important;
          }
      
          /* 5. FIX: Date/Tag Visibility */
          .pagefind-ui__result-tag {
              color: #ffffff !important;           /* White text */
              background-color: #222222 !important; /* Dark background */
              border: 1px solid #444444 !important; /* Subtle border */
          }
          
          .pagefind-ui__result {
              border-bottom: 1px solid #333 !important;
          }
      
          /* MOBILE ADJUSTMENTS (Phones) */
          @media screen and (max-width: 600px) {
              .nav .flat { justify-content: flex-start; }
      
              li.search-wrap {
                  margin-left: 0 !important; 
                  width: 100%; 
                  margin-top: 15px; 
                  /* On mobile, revert to relative so results flow naturally below input */
                  position: relative !important; 
              }
      
              #search { width: 100%; }
              
              .pagefind-ui__drawer {
                  top: 100% !important; 
                  right: 0 !important;
                  left: 0 !important;
                  width: 100% !important; 
                  max-width: none !important;
                  border: none !important;
                  border-top: 1px solid #333 !important;
                  border-radius: 0 !important;
                  box-shadow: none !important;
              }
          }
      </style>

	  <!-- WRAPPED IN LI TAG -->
	  <li class="search-wrap">
		<div id="search"></div>
	  </li>
	  <script>
				window.addEventListener('DOMContentLoaded', (event) => {
					new PagefindUI({element: "#search"});
				});
	  </script>
	</ul>
  </nav>
</div>
